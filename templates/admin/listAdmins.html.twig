{% extends 'admin/baseAdmin.html.twig' %}

{% block head %}
<link rel="stylesheet" href="{{ asset('assetsdheker/css/adminUsers.css') }}">
<style>
	/* Boutons sans bordure */
	.btn-outline-danger.btn-no-border,
	.btn-outline-secondary.btn-no-border {
		border-color: transparent !important;
	}

	/* Modal CSS pur */
	.css-modal {
		position: fixed;
		top: 0;
		left: 0;
		width: 100vw;
		height: 100vh;
		background-color: rgba(0, 0, 0, 0.5);
		display: none;
		align-items: flex-start;
		justify-content: center;
		padding-top: 120px;
		z-index: 1000;
	}

	.css-modal-box {
		background-color: #fff;
		border-radius: 16px;
		padding: 2rem;
		box-shadow: 0 5px 25px rgba(0, 0, 0, 0.3);
		width: 90%;
		max-width: 400px;
		text-align: center;
		animation: fadeIn 0.3s ease-in-out;
		z-index: 1001;
		font-family: 'Segoe UI', sans-serif;
	}

	.css-modal-box p {
		font-size: 18px;
		color: #555;
		margin-bottom: 1.5rem;
	}

	.css-modal-box strong {
		color: #3c2c4e;
	}

	.css-modal-box .btn {
		padding: 0.5rem 1.2rem;
		font-size: 14px;
		border-radius: 6px;
		cursor: pointer;
		margin: 0 5px;
	}

	.css-modal-box .btn-danger {
		background-color: #d33;
		color: white;
		border: none;
	}

	.css-modal-box .btn-secondary {
		background-color: #6c757d;
		color: white;
		border: none;
	}

	.css-modal-overlay {
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		cursor: pointer;
	}

	input[type="checkbox"]:checked + .css-modal {
		display: flex;
	}

	@keyframes fadeIn {
		from {
			opacity: 0;
			transform: translateY(-20px);
		}
		to {
			opacity: 1;
			transform: translateY(0);
		}
	}
</style>
{{ parent() }}
{% endblock %}

{% block section %}
<div class="admin-mui-wrapper">
	<h2>üë• Users Management</h2>

	<div class="admin-filters">
		<input type="text" id="userSearchInput" class="form-control" placeholder="üîç Search users...">
		<a href="{{ path('app_user_export_pdf') }}" target="_blank" class="main-btn primary-btn btn-hover export-btn">
			<i class="lni lni-printer"></i> Export PDF
		</a>
		<a href="{{ path('admin_show_add_form') }}" class="main-btn info-btn btn-hover export-btn">
			<i class="lni lni-plus"></i> Add Admin
		</a>
		<a href="{{ path('app_user_export_excel') }}" target="_blank" class="main-btn success-btn btn-hover export-btn">
			<i class="lni lni-exit-up"></i> Export Excel
		</a>
	</div>

	<table class="admin-mui-table">
		<thead>
			<tr>
				<th>Username</th>
				<th>Email</th>
				<th>Role</th>
				<th>Actions</th>
			</tr>
		</thead>
		<tbody id="userTable">
			{% for user in users %}
				<tr>
					<td>{{ user.username }}</td>
					<td>{{ user.email }}</td>
					<td>{{ user.role }}</td>
					<td>
						<!-- ‚úÖ Corbeille cliquable -->
						<label for="confirm-{{ user.idUser }}" class="btn btn-outline-danger btn-sm btn-no-border">üóëÔ∏è</label>

						<!-- ‚úÖ Input toggle cach√© -->
						<input type="checkbox" id="confirm-{{ user.idUser }}" hidden>

						<!-- ‚úÖ Pop-up CSS -->
						<div class="css-modal">
							<label for="confirm-{{ user.idUser }}" class="css-modal-overlay"></label>
							<div class="css-modal-box">
								<p>Are you sure you want to delete <strong>{{ user.username }}</strong>?</p>
								<form method="POST" action="{{ path('app_user_delete', {'idUser': user.idUser}) }}">
									<input type="hidden" name="_method" value="POST">
									<button type="submit" class="btn btn-danger">Yes</button>
									<label for="confirm-{{ user.idUser }}" class="btn btn-secondary">Cancel</label>
								</form>
							</div>
						</div>

						<!-- ‚ùå Autre action -->
						<button class="btn btn-outline-secondary btn-sm btn-no-border" title="Block User" data-id="{{ user.idUser }}">üö´</button>
					</td>
				</tr>
			{% else %}
				<tr>
					<td colspan="4" class="empty-row">No users found.</td>
				</tr>
			{% endfor %}
		</tbody>
	</table>
</div>
{% endblock %}
